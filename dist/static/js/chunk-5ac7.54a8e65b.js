(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5ac7"],{"6CXL":function(e,t,n){},"6bP5":function(e,t,n){"use strict";var a=n("Qq1u");n.n(a).a},Hycs:function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"a",function(){return o}),n.d(t,"d",function(){return l}),n.d(t,"b",function(){return u});var a=n("t3Un"),i=n("Qyje"),r=n.n(i);function s(e){return Object(a.a)({url:"menu",method:"get",params:e})}function o(e){return Object(a.a)({url:"menu/add",method:"post",data:r.a.stringify(e)})}function l(e){return Object(a.a)({url:"menu/edit",method:"post",data:r.a.stringify(e)})}function u(e){return Object(a.a)({url:"menu/del",method:"post",data:r.a.stringify(e)})}},Qd7o:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n("rfXi"),i=n.n(a),r=n("Kw5r");function s(e,t,n,a,o){var l=[],u=[];return i()(e).forEach(function(e){void 0===e._expanded&&r.default.set(e,"_expanded",t);var i=1;if(void 0!==a&&null!==a&&(i=a+1),r.default.set(e,"_level",i),n?(r.default.set(e,"parent",n),l[i]||(l[i]=0),r.default.set(e,"_marginLeft",l[i]+n._marginLeft),r.default.set(e,"_width",e[o]/n[o]*n._width),l[i]+=e._width):(l[e.id]=[],l[e.id][i]=0,r.default.set(e,"_marginLeft",0),r.default.set(e,"_width",1)),u.push(e),e.children&&e.children.length>0){var c=s(e.children,t,e,i,o);u=u.concat(c)}}),u}},Qq1u:function(e,t,n){},WRkR:function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"a",function(){return o}),n.d(t,"d",function(){return l}),n.d(t,"b",function(){return u});var a=n("t3Un"),i=n("Qyje"),r=n.n(i);function s(e){return Object(a.a)({url:"domain/list",method:"get",params:e})}function o(e){return Object(a.a)({url:"domain/add",method:"post",data:r.a.stringify(e)})}function l(e){return Object(a.a)({url:"domain/edit",method:"post",data:r.a.stringify(e)})}function u(e){return Object(a.a)({url:"domain/del",method:"post",data:r.a.stringify(e)})}},XYqI:function(e,t,n){"use strict";n.r(t);var a=n("P2sY"),i=n.n(a),r=n("gDS+"),s=n.n(r),o=n("itRl"),l=n("Qd7o"),u=/\.\/(.*)\.svg/,c=function(e){return e.keys()}(n("Uf/o")).map(function(e){return e.match(u)[1]}),d=n("Hycs"),m=n("WRkR"),p={name:"Menu",components:{treeTable:o.a},filters:{tag:function(e){return"1"===e?"菜单":"按钮"}},data:function(){return{func:l.a,expandAll:!1,list:{},args:[null,null,"timeLine"],columns:[{value:"name",text:this.$t("menu.name")}],temp:{id:void 0,name:"",menu_type:"1",url:"",order_num:1,perms:"",icon:"",parents:["0"]},icons:c,dialogFormVisible:!1,dialogStatus:"create",textMap:{update:"Edit",create:"Create"},rules:{type:[{required:!0,message:"type is required",trigger:"change"}],timestamp:[{type:"date",required:!0,message:"timestamp is required",trigger:"change"}],name:[{required:!0,message:"名称必须填写",trigger:"blur"}],order_num:[{required:!0,message:"排序必须填写",trigger:"blur"}]},index:1,data_copy:[],data_options:[],cascader_props:{value:"id",label:"name"},domainlist:[],domain_id:""}},mounted:function(){},created:function(){this.getDeptList()},methods:{os:function(e){var t=this;e.forEach(function(e){t.data_copy.push(e),e.children&&Array.isArray(e.children)&&t.os(e.children)})},oks:function(e){if(e<this.data_copy.length){var t=this;this.autoCreate(this.data_copy[e]).then(function(n){t.oks(e+1)})}},getDeptList:function(){var e=this;this.listLoading=!0,Object(m.c)().then(function(t){e.domainlist=t.data.result,""===e.domain_id&&e.domainlist&&e.domainlist.length>0&&(e.domain_id=e.domainlist[0].id,e.getList()),setTimeout(function(){e.listLoading=!1},1500)})},getList:function(){var e=this;this.listLoading=!0,Object(d.c)({domain_id:this.domain_id}).then(function(t){var n=t.data.result;n&&n.length>0?(e.list=e.o(n,0),e.data_options=[{id:"0",name:"一级菜单",children:e.list}]):(e.list=[],e.data_options=[{id:"0",name:"一级菜单"}]),setTimeout(function(){e.listLoading=!1},1500)})},o:function(e,t){var n=this,a=e.filter(function(e){return e.parent_id===t.toString()});return a.forEach(function(t){var a=n.o(e,t.id);a&&a.length>0&&(t.children=a)}),a},recursive:function(e,t){var n=this,a=[],i=[],r=1;return e.forEach(function(e){if(e.permission||!1!==e.permission){if(i={name:n.$t("route."+e.meta.title),label:n.$t("route."+e.meta.title),icon:e.meta.icon,id:n.index,value:n.index,order_num:r,url:"{}"===s()(t)?e.path:t.url+"/"+e.path,parent_id:"{}"===s()(t)?0:t.id,perms:"",menu_type:"1"},n.index+=1,r+=1,e.children&&Array.isArray(e.children)&&(i.children=n.recursive(e.children,i)),e.auth&&Array.isArray(e.auth)){var o=[],l={},u=1;e.auth.forEach(function(e){l={name:e.name,label:e.name,icon:"",id:n.index,value:n.index,order_num:u,url:"",parent_id:i.id,perms:i.url+":"+e.code,menu_type:"2"},o.push(l),n.index+=1,u+=1}),i.children=o}a.push(i)}}),a},findParent:function(e,t,n){var a=this;return n.forEach(function(n){n.id===e&&(t.push(n.parent_id),a.findParent(n.parent_id,t,a.list)),n.children&&Array.isArray(n.children)&&a.findParent(e,t,n.children)}),t},resetTemp:function(){this.temp={id:void 0,name:"",menu_type:"1",url:"",order_num:1,perms:"",icon:"",parents:["0"]}},handleCreate:function(){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},handleUpdate:function(e){this.temp=i()({},e),this.temp.timestamp=new Date(this.temp.timestamp),this.temp.parents=[],this.findParent(this.temp.id,this.temp.parents,this.list),this.temp.parents.reverse(),this.dialogStatus="update",this.dialogFormVisible=!0},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(d.b)({id:e.id}).then(function(){t.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3}),t.getList()}).catch(function(e){t.$message.error(e.msg)})}).catch(function(){})},createData:function(){var e=this;this.$refs.dataForm.validate(function(t){if(t){if(""===e.temp.url&&"1"===e.temp.menu_type)return void e.$message.error("请输入路由地址");if(""===e.temp.perms&&"2"===e.temp.menu_type)return void e.$message.error("请输入授权标识");e.temp.id=parseInt(100*Math.random())+1024,e.temp.author="vue-element-admin",e.temp.domain_id=e.domain_id,e.temp.parent_id=e.temp.parents[e.temp.parents.length-1],delete e.temp.parent,Object(d.a)(e.temp).then(function(){e.getList(),e.dialogFormVisible=!1,e.$notify({name:"成功",message:"创建成功",type:"success",duration:2e3})}).catch(function(t){e.$message.error(t.msg)})}})},autoCreate:function(e){return this.temp=e,this.temp.name=e.name,this.temp.url=e.url,this.temp.perms=e.perms,this.temp.menu_type=e.menu_type,this.temp.parent_id=e.parent_id,this.temp.domain_id=this.domain_id,delete this.temp.children,Object(d.a)(this.temp)},updateData:function(){var e=this;this.$refs.dataForm.validate(function(t){if(t){if(""===e.temp.url&&"1"===e.temp.menu_type)return void e.$message.error("请输入路由地址");if(""===e.temp.perms&&"2"===e.temp.menu_type)return void e.$message.error("请输入授权标识");delete e.temp.children,e.temp.domain_id=e.domain_id;var n=i()({},e.temp);n.timestamp=+new Date(n.timestamp),n.parent_id=n.parents[e.temp.parents.length-1],delete n.parent,Object(d.d)(n).then(function(){e.getList(),e.dialogFormVisible=!1,e.$notify({name:"成功",message:"更新成功",type:"success",duration:2e3})}).catch(function(t){e.$message.error(t.msg)})}})}}},f=n("KHd+"),h=Object(f.a)(p,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},on:{change:e.getList},model:{value:e.domain_id,callback:function(t){e.domain_id=t},expression:"domain_id"}},e._l(e.domainlist,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getList}},[e._v("\n      "+e._s(e.$t("table.search"))+"\n    ")]),e._v(" "),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["/auth-system/menu:add"],expression:"['/auth-system/menu:add']"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v(e._s(e.$t("table.add"))+"\n    ")])],1),e._v(" "),e.domain_id&&e.list?[n("tree-table",{attrs:{data:e.list,"eval-func":e.func,"eval-args":e.args,columns:e.columns,"expand-all":e.expandAll,border:""}},[n("el-table-column",{attrs:{label:e.$t("menu.icon"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.icon?n("svg-icon",{attrs:{"icon-class":t.row.icon}}):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{label:e.$t("menu.type"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.menu_type?n("el-tag",[e._v(e._s(e._f("tag")(t.row.menu_type)))]):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{label:e.$t("menu.topnum"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.order_num)+"\n        ")]}}])}),e._v(" "),n("el-table-column",{attrs:{label:e.$t("menu.router"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.url)+"\n        ")]}}])}),e._v(" "),n("el-table-column",{attrs:{label:e.$t("menu.auth"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.perms)+"\n        ")]}}])}),e._v(" "),n("el-table-column",{attrs:{label:e.$t("menu.actions"),width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.id?[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["/auth-system/menu:edit"],expression:"['/auth-system/menu:edit']"}],attrs:{type:"text"},on:{click:function(n){e.handleUpdate(t.row)}}},[e._v(e._s(e.$t("table.edit"))+"\n          ")]),e._v(" "),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["/auth-system/menu:del"],expression:"['/auth-system/menu:del']"}],attrs:{type:"text"},on:{click:function(n){e.handleDelete(t.row)}}},[e._v(e._s(e.$t("table.delete"))+"\n          ")])]:void 0}}])})],1)]:e._e(),e._v(" "),n("el-dialog",{attrs:{name:e.$t("menu."+e.textMap[e.dialogStatus]),visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("el-form",{ref:"dataForm",staticStyle:{margin:"0 50px"},attrs:{rules:e.rules,model:e.temp,"label-position":"left","label-width":"80px"}},[n("el-form-item",{attrs:{label:e.$t("menu.type")}},[n("el-radio-group",{model:{value:e.temp.menu_type,callback:function(t){e.$set(e.temp,"menu_type",t)},expression:"temp.menu_type"}},[n("el-radio-button",{attrs:{label:"1"}},[e._v(e._s(e.$t("menu.type_menu")))]),e._v(" "),n("el-radio-button",{attrs:{label:"2"}},[e._v(e._s(e.$t("menu.type_button")))])],1)],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("menu.name"),prop:"name"}},[n("el-input",{model:{value:e.temp.name,callback:function(t){e.$set(e.temp,"name",t)},expression:"temp.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("menu.parents")}},[n("el-cascader",{style:{width:"100%"},attrs:{options:e.data_options,props:e.cascader_props,"change-on-select":""},model:{value:e.temp.parents,callback:function(t){e.$set(e.temp,"parents",t)},expression:"temp.parents"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("menu.topnum"),prop:"order_num"}},[n("el-input",{model:{value:e.temp.order_num,callback:function(t){e.$set(e.temp,"order_num",t)},expression:"temp.order_num"}})],1),e._v(" "),"1"===e.temp.menu_type?n("el-form-item",{attrs:{label:e.$t("menu.router")}},[n("el-input",{model:{value:e.temp.url,callback:function(t){e.$set(e.temp,"url",t)},expression:"temp.url"}})],1):e._e(),e._v(" "),"2"===e.temp.menu_type?n("el-form-item",{attrs:{label:e.$t("menu.auth")}},[n("el-input",{model:{value:e.temp.perms,callback:function(t){e.$set(e.temp,"perms",t)},expression:"temp.perms"}})],1):e._e(),e._v(" "),"1"===e.temp.menu_type?n("el-form-item",{attrs:{label:e.$t("menu.icon")}},[n("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select"},model:{value:e.temp.icon,callback:function(t){e.$set(e.temp,"icon",t)},expression:"temp.icon"}},e._l(e.icons,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}},[n("svg-icon",{attrs:{"icon-class":e}})],1)}))],1):e._e()],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(e._s(e.$t("table.cancel")))]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){"create"===e.dialogStatus?e.createData():e.updateData()}}},[e._v(e._s(e.$t("table.confirm"))+"\n      ")])],1)],1)],2)},[],!1,null,null,null);h.options.__file="menu.vue";t.default=h.exports},itRl:function(e,t,n){"use strict";var a=n("jr1U"),i=n.n(a),r=n("rfXi"),s=n.n(r),o=n("Kw5r");function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=[];return s()(e).forEach(function(e){void 0===e._expanded&&o.default.set(e,"_expanded",t);var r=1;if(void 0!==a&&null!==a&&(r=a+1),o.default.set(e,"_level",r),n&&o.default.set(e,"parent",n),i.push(e),e.children&&e.children.length>0){var s=l(e.children,t,e,r);i=i.concat(s)}}),i}var u={name:"TreeTable",props:{data:{type:[Array,Object],required:!0},columns:{type:Array,default:function(){return[]}},evalFunc:Function,evalArgs:Array,expandAll:{type:Boolean,default:!1}},computed:{formatData:function(){var e=void 0;e=Array.isArray(this.data)?this.data:[this.data];var t=this.evalFunc||l,n=this.evalArgs?i()([e,this.expandAll],this.evalArgs):[e,this.expandAll];return t.apply(null,n)}},methods:{showRow:function(e){var t=!e.row.parent||e.row.parent._expanded&&e.row.parent._show;return e.row._show=t,t?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},toggleExpanded:function(e){var t=this.formatData[e];t._expanded=!t._expanded},iconShow:function(e,t){return 0===e&&t.children&&t.children.length>0}}},c=(n("6bP5"),n("vhXz"),n("KHd+")),d=Object(c.a)(u,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-table",e._b({attrs:{data:e.formatData,"row-style":e.showRow}},"el-table",e.$attrs,!1),[0===e.columns.length?n("el-table-column",{attrs:{width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row._level,function(e){return n("span",{key:e,staticClass:"ms-tree-space"})}),e._v(" "),e.iconShow(0,t.row)?n("span",{staticClass:"tree-ctrl",on:{click:function(n){e.toggleExpanded(t.$index)}}},[t.row._expanded?n("i",{staticClass:"el-icon-minus"}):n("i",{staticClass:"el-icon-plus"})]):e._e(),e._v("\n      "+e._s(t.$index)+"\n    ")]}}])}):e._l(e.columns,function(t,a){return n("el-table-column",{key:t.value,attrs:{label:t.text,width:t.width},scopedSlots:e._u([{key:"default",fn:function(i){return[e._l(i.row._level,function(t){return 0===a?n("span",{key:t,staticClass:"ms-tree-space"}):e._e()}),e._v(" "),e.iconShow(a,i.row)?n("span",{staticClass:"tree-ctrl",on:{click:function(t){e.toggleExpanded(i.$index)}}},[i.row._expanded?n("i",{staticClass:"el-icon-minus"}):n("i",{staticClass:"el-icon-plus"})]):e._e(),e._v("\n      "+e._s(i.row[t.value])+"\n    ")]}}])})}),e._v(" "),e._t("default")],2)},[],!1,null,"414e2741",null);d.options.__file="index.vue";t.a=d.exports},jr1U:function(e,t,n){e.exports={default:n("wObO"),__esModule:!0}},vhXz:function(e,t,n){"use strict";var a=n("6CXL");n.n(a).a},wObO:function(e,t){e.exports=function(){return Function.call.apply(Array.prototype.concat,arguments)}}}]);